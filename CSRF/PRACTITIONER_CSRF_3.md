## Detailed Writeup of Csrf Practitioner Lab(**CSRF where token is not tied to user session**)

Date:-9 January 2025
Level:-Practitioner

I am here to solve CSRF lab,as we have said in the description Token is not tied to user session
therefore we have to seek the parameter which change it values as the new session introducede.

We have provided the two credentials given below are:-

**Username:Password**
# wiener:peter
# carlos:montoya

At first,i log in to the account using credential  wiener:peter and get a dasboard to update my email,i just enter some mail and change it.

Then i write the mail for update and capture the request on **Burp Suite Professional** and send the request to repeater.

I get three parameters which can manipurate the user session named
-Cookies : Session id
-Csrf token value
-Email value

I tried to remove the *CSRF token* first and send the request but it shows error shows *Invalid Csrf token* which let me know that the token is important.,then i undo the changes and change the mail and send the request and we can easily be able to *change the email* so i get to know that there is *vunerablity in email section*.

Then i loaded the request and see that the there is change in csrf token everytime.

Then i tried to manipulate the token so i logged in into anathor account with the credential 
carlos:montoya
and fill the details and capture the token of that particular session.

I changed the token and pass the request and get 302-Found ,Boom i just discoved the Vunerablity that the Server is Accepted Any User session token.

I generate a HTML field using *Engagement tools* in *CSRF-Poc Gemerator* and go to the website exploit server and store the following code given below:-

<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a0900ad04e2991781e466eb0076006c.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="wiener&#64;tes&#46;com" />
      <input type="hidden" name="csrf" value="Khozrv7hia5gH2BXYq2P7ZcNr8DkEVuP" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

Then i change the csrf value with the new csrf(never used before) token from the Second account and change email and send to victim server.

I got the changed email and Boom we just solved the lab.

**Key-Learning**:-A unique token have to always tied to user session otherwise it can lead to vunerablity on the website leading to manipulate the information od server.

Thankyou!!!




